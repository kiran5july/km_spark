
var inputHDFSPath ="/hdfs/path"
def funFileName: ((String) => String) = { (s) =>(s.split("/").last)}

import org.apache.spark.sql.functions.udf
val udfFileName = udf(funFileName)

var df_data=spark.read.
 options(Map("delimiter"->"|", "header"->"true", "quoteAll"->"True")).
 csv(inputHDFSPath+ "/*.gz").
 toDF("col1").
 withColumn("file_name", udfFileName(input_file_name()))

